<?xml version="1.0" encoding="UTF-8"?>
<pd:ProcessDefinition xmlns:pd="http://xmlns.tibco.com/bw/process/2003" xmlns:ns1="http://www.tibco.com/namespaces/tnt/plugins/file" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:ns="http://www.tibco.com/pe/DeployedVarsType" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:tib="http://www.tibco.com/bw/xslt/custom-functions" xmlns:ns12="http://www.tibco.com/namespaces/tnt/plugins/file/v2" xmlns:pfx7="nsUsosResponseBank" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <xsd:import namespace="nsUsosResponseBank" schemaLocation="/Novelties_Users_Transactions.Core/SendFilesMail/Send_RejectedTransactions_File/Schemas/BankValidationsResponse.xsd"/>
    <pd:name>Novelties_Users_Transactions.Core/SendFilesMail/Report_Transactions/Read_Acepted_Rejected_Transactions_TEST.process</pd:name>
    <pd:startName>Start</pd:startName>
    <pd:startX>39</pd:startX>
    <pd:startY>35</pd:startY>
    <pd:returnBindings>
        <Rejected_Files>
            <Count_Rejected>
                <xsl:value-of select="$Write-Injustified/ns1:WriteActivityOutputClass/fileInfo/fullName"/>
            </Count_Rejected>
            <Detail_Rejected>
                <xsl:value-of select="$Write_Detail_BankRejected_Novelties/ns1:WriteActivityOutputClass/fileInfo/fullName"/>
            </Detail_Rejected>
        </Rejected_Files>
    </pd:returnBindings>
    <pd:endName>End</pd:endName>
    <pd:endType>
        <xsd:element name="Rejected_Files">
            <xsd:complexType>
                <xsd:sequence>
                    <xsd:element name="Count_Rejected" type="xsd:string"/>
                    <xsd:element name="Detail_Rejected" type="xsd:string"/>
                </xsd:sequence>
            </xsd:complexType>
        </xsd:element>
    </pd:endType>
    <pd:endX>1811</pd:endX>
    <pd:endY>35</pd:endY>
    <pd:errorSchemas/>
    <pd:processVariables>
        <SumRejected>
            <xsd:element name="SumRejected" type="xsd:string"/>
        </SumRejected>
        <Tarjetas>
            <xsd:element name="Tarjetas" type="xsd:string"/>
        </Tarjetas>
        <Invalidos>
            <xsd:element name="Invalidos" type="xsd:string"/>
        </Invalidos>
        <SumInjustified>
            <xsd:element name="SumInjustified" type="xsd:string"/>
        </SumInjustified>
        <Processed_at>
            <xsd:element name="Processed_at" type="xsd:string"/>
        </Processed_at>
        <InvalidosRejecetd>
            <xsd:element name="InvalidosRejecetd" type="xsd:string"/>
        </InvalidosRejecetd>
    </pd:processVariables>
    <pd:targetNamespace>http://xmlns.example.com/1473090564506</pd:targetNamespace>
    <pd:group name="Group">
        <pd:type>com.tibco.pe.core.LoopGroup</pd:type>
        <pd:resourceType>ae.process.group</pd:resourceType>
        <pd:x>1011</pd:x>
        <pd:y>1</pd:y>
        <pd:width>264</pd:width>
        <pd:height>242</pd:height>
        <pd:collapsedWidth>57</pd:collapsedWidth>
        <pd:collapsedHeight>70</pd:collapsedHeight>
        <pd:groupVariables/>
        <pd:joinToggle>inherit</pd:joinToggle>
        <config>
            <pd:groupType>inputLoop</pd:groupType>
            <pd:serializable>false</pd:serializable>
            <pd:over>$SQL-Direct/jdbcGeneralActivityOutput/unknownResultset/row</pd:over>
            <pd:iterationElementSlot>QueryCompleted</pd:iterationElementSlot>
            <pd:indexSlot>h</pd:indexSlot>
            <pd:activityOutputName/>
            <pd:accumulateOutput>false</pd:accumulateOutput>
        </config>
        <pd:inputBindings/>
        <pd:expanded>true</pd:expanded>
        <pd:transition>
            <pd:from>start</pd:from>
            <pd:to>JDBC Query</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:transition>
            <pd:from>Catch</pd:from>
            <pd:to>end</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:transition>
            <pd:from>SumarInjustificados</pd:from>
            <pd:to>end</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:transition>
            <pd:from>JDBC Query</pd:from>
            <pd:to>Write_Detail_BankRejectedUnjustified</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:transition>
            <pd:from>Write_Detail_BankRejectedUnjustified</pd:from>
            <pd:to>SumarInjustificados</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:activity name="Write_Detail_BankRejectedUnjustified">
            <pd:type>com.tibco.plugin.file.FileWriteActivity</pd:type>
            <pd:resourceType>ae.activities.FileWriteActivity</pd:resourceType>
            <pd:x>1086</pd:x>
            <pd:y>62</pd:y>
            <config>
                <encoding>text</encoding>
                <compressFile>None</compressFile>
                <append>true</append>
                <createMissingDirectories>true</createMissingDirectories>
            </config>
            <pd:inputBindings>
                <ns1:WriteActivityInputTextClass>
                    <fileName>
                        <xsl:value-of select="concat($_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Detail_Rejected_Path,&#xA;tib:format-date(&quot;yyyyMMdd&quot;, tib:add-to-date(current-date(), 0, 0, -1)),&#xA;$_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Detail_Rejected_Prefix,&#xA;$_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Extension)"/>
                    </fileName>
                    <textContent>
                        <xsl:value-of select="concat($JDBC-Query/resultSet/Record[1]/transactionsequencenumber,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;$_globalVariables/ns:GlobalVariables/Noveltys_Request/Bank_Code,&quot;&#x9;&quot;,&quot;&#x9;  &quot;,&quot;&#x9;&quot;,&quot; &quot;,&#xA;$JDBC-Query/resultSet/Record[1]/usagedate,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;$JDBC-Query/resultSet/Record[1]/fcscardnumber,&quot;&#x9;&quot;,&quot;  &quot;,&#xA;$JDBC-Query/resultSet/Record[1]/amountused,&quot;&#x9;&quot;,&quot;&#x9;&quot;, &quot; &quot;,&#xA;tib:pad(tib:trim(normalize-space(substring($JDBC-Query/resultSet/Record[1]/stationbusstopnm, 1, 24))), 24, &quot; &quot;),&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;$JDBC-Query/resultSet/Record[1]/stationbusstopid,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;$JDBC-Query/resultSet/Record[1]/DocumentID,&quot;&#x9;&quot;,&#xA;tib:trim(normalize-space($JDBC-Query/resultSet/Record[1]/Names)),&quot;&#x9;&quot;,&quot; &quot;,&#xA;tib:pad(tib:trim(normalize-space($JDBC-Query/resultSet/Record[1]/LastName1)), 16, &quot; &quot;),&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot; &quot;,&#xA;tib:pad(tib:trim(normalize-space($JDBC-Query/resultSet/Record[1]/LastName2)), 16, &quot; &quot;),&quot; &quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;$JDBC-Query/resultSet/Record[1]/status_novelty,&#xA;&quot;&#xA;&quot;)"/>
                    </textContent>
                    <encoding>
                        <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Encoding"/>
                    </encoding>
                </ns1:WriteActivityInputTextClass>
            </pd:inputBindings>
        </pd:activity>
        <pd:activity name="JDBC Query">
            <pd:type>com.tibco.plugin.jdbc.JDBCQueryActivity</pd:type>
            <pd:resourceType>ae.activities.JDBCQueryActivity</pd:resourceType>
            <pd:x>1085</pd:x>
            <pd:y>163</pd:y>
            <config>
                <timeout>%%Connections/MiddlewareDB/TimeOut%%</timeout>
                <commit>false</commit>
                <maxRows>%%Connections/MiddlewareDB/Max_Rows%%</maxRows>
                <emptyStrAsNil>false</emptyStrAsNil>
                <jdbcSharedConfig>/Connections/JDBCTIBCO.sharedjdbc</jdbcSharedConfig>
                <statement>select transactions.transactionsequencenumber, transactions.usagedate, transactions.fcscardnumber, transactions.amountused, transactions.stationbusstopnm, transactions.stationbusstopid, hcusers.DocumentID, hcusers.Names, hcusers.LastName1, hcusers.LastName2, Prueba_noveltyReceiverBankFile2.status_novelty from transactions, hcusers, Prueba_noveltyReceiverBankFile2 where transactions.FCSCardNumber=hcusers.TransportCardNumber and transactions.FCSCardNumber=Prueba_noveltyReceiverBankFile2.card_number and transactions.FCSCardNumber=? and transactions.ClearingDate=?;</statement>
                <wizardData/>
                <Prepared_Param_DataType>
                    <parameter>
                        <parameterName>FCS_CardNumber</parameterName>
                        <dataType>VARCHAR</dataType>
                    </parameter>
                    <parameter>
                        <parameterName>ClearingDate</parameterName>
                        <dataType>VARCHAR</dataType>
                    </parameter>
                </Prepared_Param_DataType>
                <oraObjects/>
                <oraTables/>
                <QueryOutputCachedSchemaColumns>transactionsequencenumber</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>usagedate</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>fcscardnumber</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>amountused</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>stationbusstopnm</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>stationbusstopid</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>DocumentID</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>Names</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>LastName1</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>LastName2</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>status_novelty</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            </config>
            <pd:inputBindings>
                <jdbcQueryActivityInput>
                    <FCS_CardNumber>
                        <xsl:copy-of select="$QueryCompleted/row/column[name='card_number']/value/@xsi:nil"/>
                        <xsl:value-of select="$QueryCompleted/row/column[name='card_number']/value"/>
                    </FCS_CardNumber>
                    <ClearingDate>
                        <xsl:value-of select="tib:format-date(&quot;yyyyMMdd&quot;,tib:add-to-date(current-date(), 0, 0, -1))"/>
                    </ClearingDate>
                </jdbcQueryActivityInput>
            </pd:inputBindings>
        </pd:activity>
        <pd:activity name="SumarInjustificados">
            <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
            <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
            <pd:x>1200</pd:x>
            <pd:y>63</pd:y>
            <config>
                <variableName>SumInjustified</variableName>
            </config>
            <pd:inputBindings>
                <SumInjustified>
                    <xsl:value-of select="$SumInjustified/SumInjustified + $JDBC-Query/resultSet/Record[1]/amountused"/>
                </SumInjustified>
            </pd:inputBindings>
        </pd:activity>
        <pd:activity name="Catch">
            <pd:type>com.tibco.pe.core.CatchActivity</pd:type>
            <pd:resourceType>ae.activities.catch</pd:resourceType>
            <pd:x>1189</pd:x>
            <pd:y>167</pd:y>
            <pd:handler>true</pd:handler>
            <config>
                <catchAll>true</catchAll>
            </config>
            <pd:inputBindings/>
        </pd:activity>
    </pd:group>
    <pd:group name="Group (1)">
        <pd:type>com.tibco.pe.core.LoopGroup</pd:type>
        <pd:resourceType>ae.process.group</pd:resourceType>
        <pd:x>1190</pd:x>
        <pd:y>306</pd:y>
        <pd:width>285</pd:width>
        <pd:height>245</pd:height>
        <pd:collapsedWidth>57</pd:collapsedWidth>
        <pd:collapsedHeight>70</pd:collapsedHeight>
        <pd:groupVariables/>
        <pd:joinToggle>inherit</pd:joinToggle>
        <config>
            <pd:groupType>inputLoop</pd:groupType>
            <pd:serializable>false</pd:serializable>
            <pd:over>$SQL-Direct-00/jdbcGeneralActivityOutput/unknownResultset/row</pd:over>
            <pd:iterationElementSlot>QueryCompleted00</pd:iterationElementSlot>
            <pd:indexSlot>k</pd:indexSlot>
            <pd:activityOutputName/>
            <pd:accumulateOutput>false</pd:accumulateOutput>
        </config>
        <pd:inputBindings/>
        <pd:expanded>true</pd:expanded>
        <pd:transition>
            <pd:from>start</pd:from>
            <pd:to>JDBC-Query-00</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:transition>
            <pd:from>Catch-Rejected</pd:from>
            <pd:to>end</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:transition>
            <pd:from>SumarRejected-00</pd:from>
            <pd:to>end</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:transition>
            <pd:from>JDBC-Query-00</pd:from>
            <pd:to>Write_Detail_BankRejectedUnjustified-00</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:transition>
            <pd:from>Write_Detail_BankRejectedUnjustified-00</pd:from>
            <pd:to>SumarRejected-00</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:activity name="Write_Detail_BankRejectedUnjustified-00">
            <pd:type>com.tibco.plugin.file.FileWriteActivity</pd:type>
            <pd:resourceType>ae.activities.FileWriteActivity</pd:resourceType>
            <pd:x>1263</pd:x>
            <pd:y>367</pd:y>
            <config>
                <encoding>text</encoding>
                <compressFile>None</compressFile>
                <append>true</append>
                <createMissingDirectories>true</createMissingDirectories>
            </config>
            <pd:inputBindings>
                <ns1:WriteActivityInputTextClass>
                    <fileName>
                        <xsl:value-of select="concat($_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Detail_Rejected_Path,&#xA;tib:format-date(&quot;yyyyMMdd&quot;, tib:add-to-date(current-date(), 0, 0, -1)),&#xA;$_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Detail_Rejected_Prefix,&#xA;$_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Extension)"/>
                    </fileName>
                    <textContent>
                        <xsl:value-of select="concat($JDBC-Query-00/resultSet/Record[1]/transactionsequencenumber,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;$_globalVariables/ns:GlobalVariables/Noveltys_Request/Bank_Code,&quot;&#x9;&quot;,&quot;&#x9;  &quot;,&quot;&#x9;&quot;,&quot; &quot;,&#xA;$JDBC-Query-00/resultSet/Record[1]/usagedate,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;$JDBC-Query-00/resultSet/Record[1]/fcscardnumber,&quot;&#x9;&quot;,&quot;  &quot;,&#xA;$JDBC-Query-00/resultSet/Record[1]/amountused,&quot;&#x9;&quot;,&quot;&#x9;&quot;, &quot; &quot;,&#xA;tib:pad(tib:trim(normalize-space(substring($JDBC-Query-00/resultSet/Record[1]/stationbusstopnm, 1, 24))), 24, &quot; &quot;),&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;$JDBC-Query-00/resultSet/Record[1]/stationbusstopid,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;$JDBC-Query-00/resultSet/Record[1]/DocumentID,&quot;&#x9;&quot;,&#xA;tib:pad(tib:trim(normalize-space($JDBC-Query-00/resultSet/Record[1]/Names)), 16, &quot; &quot;),&quot;&#x9;&quot;,&quot; &quot;,&#xA;tib:pad(tib:trim(normalize-space($JDBC-Query-00/resultSet/Record[1]/LastName1)), 16, &quot; &quot;),&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot; &quot;,&#xA;tib:pad(tib:trim(normalize-space($JDBC-Query-00/resultSet/Record[1]/LastName2)), 16, &quot; &quot;),&quot; &quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;$QueryCompleted00/row/column[name='status_novelty']/value,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;$JDBC-Query-00/resultSet/Record[1]/processed_at,&#xA;&quot;&#xA;&quot;)"/>
                    </textContent>
                    <encoding>
                        <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Encoding"/>
                    </encoding>
                </ns1:WriteActivityInputTextClass>
            </pd:inputBindings>
        </pd:activity>
        <pd:activity name="JDBC-Query-00">
            <pd:type>com.tibco.plugin.jdbc.JDBCQueryActivity</pd:type>
            <pd:resourceType>ae.activities.JDBCQueryActivity</pd:resourceType>
            <pd:x>1263</pd:x>
            <pd:y>469</pd:y>
            <config>
                <timeout>%%Connections/MiddlewareDB/TimeOut%%</timeout>
                <commit>false</commit>
                <maxRows>%%Connections/MiddlewareDB/Max_Rows%%</maxRows>
                <emptyStrAsNil>false</emptyStrAsNil>
                <jdbcSharedConfig>/Connections/JDBCTIBCO.sharedjdbc</jdbcSharedConfig>
                <statement>select transactions.transactionsequencenumber, transactions.usagedate, transactions.fcscardnumber, transactions.amountused, transactions.stationbusstopnm, transactions.stationbusstopid, hcusers.DocumentID, hcusers.Names, hcusers.LastName1, hcusers.LastName2, Prueba_noveltyReceiverBankFile2.processed_at from transactions, hcusers, Prueba_noveltyReceiverBankFile2 where transactions.FCSCardNumber=hcusers.TransportCardNumber and transactions.FCSCardNumber=Prueba_noveltyReceiverBankFile2.card_number and transactions.FCSCardNumber=? and Prueba_noveltyReceiverBankFile2.processed_at &lt;=?;</statement>
                <wizardData/>
                <Prepared_Param_DataType>
                    <parameter>
                        <parameterName>FCS_CardNumber</parameterName>
                        <dataType>VARCHAR</dataType>
                    </parameter>
                    <parameter>
                        <parameterName>ClearingDate</parameterName>
                        <dataType>VARCHAR</dataType>
                    </parameter>
                </Prepared_Param_DataType>
                <oraObjects/>
                <oraTables/>
                <QueryOutputCachedSchemaColumns>transactionsequencenumber</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>usagedate</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>fcscardnumber</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>amountused</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>stationbusstopnm</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>stationbusstopid</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>DocumentID</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>Names</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>LastName1</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>LastName2</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>processed_at</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            </config>
            <pd:inputBindings>
                <jdbcQueryActivityInput>
                    <FCS_CardNumber>
                        <xsl:choose>
                            <xsl:when test="exists($QueryCompleted00/row/column[name='card_number']/value)">
                                <xsl:value-of select="$QueryCompleted00/row/column[name='card_number']/value"/>
                            </xsl:when>
                            <xsl:otherwise>
                                <xsl:attribute name="xsi:nil">true</xsl:attribute>
                            </xsl:otherwise>
                        </xsl:choose>
                    </FCS_CardNumber>
                    <ClearingDate>
                        <xsl:value-of select="tib:format-date(&quot;yyyyMMdd&quot;,tib:add-to-date(current-date(), 0, 0, -1))"/>
                    </ClearingDate>
                </jdbcQueryActivityInput>
            </pd:inputBindings>
        </pd:activity>
        <pd:activity name="SumarRejected-00">
            <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
            <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
            <pd:x>1377</pd:x>
            <pd:y>368</pd:y>
            <config>
                <variableName>SumRejected</variableName>
            </config>
            <pd:inputBindings>
                <SumRejected>
                    <xsl:value-of select="$SumRejected/SumRejected + $JDBC-Query-00/resultSet/Record[1]/amountused"/>
                </SumRejected>
            </pd:inputBindings>
        </pd:activity>
        <pd:activity name="Catch-Rejected">
            <pd:type>com.tibco.pe.core.CatchActivity</pd:type>
            <pd:resourceType>ae.activities.catch</pd:resourceType>
            <pd:x>1366</pd:x>
            <pd:y>472</pd:y>
            <pd:handler>true</pd:handler>
            <config>
                <catchAll>true</catchAll>
            </config>
            <pd:inputBindings/>
        </pd:activity>
    </pd:group>
    <pd:group name="Write_Invalid_Rejected">
        <pd:type>com.tibco.pe.core.LoopGroup</pd:type>
        <pd:resourceType>ae.process.group</pd:resourceType>
        <pd:x>546</pd:x>
        <pd:y>1</pd:y>
        <pd:width>199</pd:width>
        <pd:height>140</pd:height>
        <pd:collapsedWidth>57</pd:collapsedWidth>
        <pd:collapsedHeight>70</pd:collapsedHeight>
        <pd:groupVariables/>
        <pd:joinToggle>inherit</pd:joinToggle>
        <config>
            <pd:groupType>inputLoop</pd:groupType>
            <pd:serializable>false</pd:serializable>
            <pd:over>$SQL-Direct/jdbcGeneralActivityOutput/unknownResultset/row</pd:over>
            <pd:iterationElementSlot>QueryInvalid</pd:iterationElementSlot>
            <pd:indexSlot>i</pd:indexSlot>
            <pd:activityOutputName/>
            <pd:accumulateOutput>false</pd:accumulateOutput>
        </config>
        <pd:inputBindings/>
        <pd:expanded>true</pd:expanded>
        <pd:transition>
            <pd:from>start</pd:from>
            <pd:to>UsosRechazadosInvalidos</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:transition>
            <pd:from>UsosRechazadosInvalidos</pd:from>
            <pd:to>end</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:activity name="UsosRechazadosInvalidos">
            <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
            <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
            <pd:x>639</pd:x>
            <pd:y>77</pd:y>
            <config>
                <variableName>Invalidos</variableName>
            </config>
            <pd:inputBindings>
                <Invalidos>
                    <xsl:value-of select="concat($Invalidos/Invalidos,&#xA;&quot;Número de tarjeta: &quot;, $QueryInvalid/row/column[name='card_number']/value,&#xA;&quot;, última novedad enviada por el banco el dia: &quot;, $QueryInvalid/row/column[name='processed_at']/value,&#xA;&quot; : &quot;,$QueryInvalid/row/column[name='status_novelty']/value, &quot;(Activación)&quot;,&#xA;  &quot;&#xA;&quot;)"/>
                </Invalidos>
            </pd:inputBindings>
        </pd:activity>
    </pd:group>
    <pd:group name="Write_Invalid_Rejected (1)">
        <pd:type>com.tibco.pe.core.LoopGroup</pd:type>
        <pd:resourceType>ae.process.group</pd:resourceType>
        <pd:x>778</pd:x>
        <pd:y>228</pd:y>
        <pd:width>184</pd:width>
        <pd:height>140</pd:height>
        <pd:collapsedWidth>57</pd:collapsedWidth>
        <pd:collapsedHeight>70</pd:collapsedHeight>
        <pd:groupVariables/>
        <pd:joinToggle>inherit</pd:joinToggle>
        <config>
            <pd:groupType>inputLoop</pd:groupType>
            <pd:serializable>false</pd:serializable>
            <pd:over>$SQL-Direct-00/jdbcGeneralActivityOutput/unknownResultset/row</pd:over>
            <pd:iterationElementSlot>QueryInvalid00</pd:iterationElementSlot>
            <pd:indexSlot>j</pd:indexSlot>
            <pd:activityOutputName/>
            <pd:accumulateOutput>false</pd:accumulateOutput>
        </config>
        <pd:inputBindings/>
        <pd:expanded>true</pd:expanded>
        <pd:transition>
            <pd:from>start</pd:from>
            <pd:to>UsosRechazadosInvalidos-00</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:transition>
            <pd:from>UsosRechazadosInvalidos-00</pd:from>
            <pd:to>end</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:activity name="UsosRechazadosInvalidos-00">
            <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
            <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
            <pd:x>865</pd:x>
            <pd:y>304</pd:y>
            <config>
                <variableName>InvalidosRejecetd</variableName>
            </config>
            <pd:inputBindings>
                <InvalidosRejecetd>
                    <xsl:value-of select="concat($Invalidos/Invalidos,&#xA;&quot;Número de tarjeta: &quot;, $QueryInvalid00/row/column[name='card_number']/value,&#xA;&quot;, última novedad enviada por el banco el dia: &quot;, $QueryInvalid00/row/column[name='processed_at']/value,&#xA;&quot; : &quot;,$QueryInvalid00/row/column[name='status_novelty']/value, &quot;(Activación)&quot;,&#xA;  &quot;&#xA;&quot;)"/>
                </InvalidosRejecetd>
            </pd:inputBindings>
        </pd:activity>
    </pd:group>
    <pd:activity name="ARFile">
        <pd:type>com.tibco.plugin.mapper.MapperActivity</pd:type>
        <pd:resourceType>ae.activities.MapperActivity</pd:resourceType>
        <pd:x>136</pd:x>
        <pd:y>35</pd:y>
        <config>
            <element ref="pfx7:root"/>
        </config>
        <pd:inputBindings>
            <pfx7:root>
                <pfx7:header>
                    <pfx7:Reservado>
                        <xsl:value-of select="substring(tib:tokenize($Read-File/ns1:ReadActivityOutputTextClass/fileContent/textContent, &quot;&#xA;&quot;)[1], 0,9)"/>
                    </pfx7:Reservado>
                    <pfx7:NumerodeRegistros>
                        <xsl:value-of select="substring(tib:tokenize($Read-File/ns1:ReadActivityOutputTextClass/fileContent/textContent,&quot;&#xA;&quot;)[1], 9,8)"/>
                    </pfx7:NumerodeRegistros>
                    <pfx7:ValoraAcumuladodeUsos>
                        <xsl:value-of select="substring(tib:tokenize($Read-File/ns1:ReadActivityOutputTextClass/fileContent/textContent, &quot;&#xA;&quot;)[1], 17,13)"/>
                    </pfx7:ValoraAcumuladodeUsos>
                    <pfx7:FechadeGeneraciondelArchivo>
                        <xsl:value-of select="substring(tib:tokenize($Read-File/ns1:ReadActivityOutputTextClass/fileContent/textContent, &quot;&#xA;&quot;)[1], 30,8)"/>
                    </pfx7:FechadeGeneraciondelArchivo>
                    <pfx7:RFU>
                        <xsl:value-of select="substring(tib:tokenize($Read-File/ns1:ReadActivityOutputTextClass/fileContent/textContent, &quot;&quot;)[1], 38,84)"/>
                    </pfx7:RFU>
                </pfx7:header>
                <xsl:for-each xmlns:xsl="http://www.w3.org/1999/XSL/Transform" select="tib:tokenize($Read-File/ns1:ReadActivityOutputTextClass/fileContent/textContent, &quot;&#xA;&quot;)[position ()>1]">
                    <pfx7:body>
                        <pfx7:IdentificadordeTransaccion>
                            <xsl:value-of select="substring(current(), 0,21)"/>
                        </pfx7:IdentificadordeTransaccion>
                        <pfx7:CodigoBanco>
                            <xsl:value-of select="substring(current(), 21,3)"/>
                        </pfx7:CodigoBanco>
                        <pfx7:fechaTransaccion>
                            <xsl:value-of select="substring(current(), 24,14)"/>
                        </pfx7:fechaTransaccion>
                        <pfx7:MontodeUso>
                            <xsl:value-of select="substring(current(), 38,7)"/>
                        </pfx7:MontodeUso>
                        <pfx7:DocumentodeIdentidad>
                            <xsl:value-of select="substring(current(), 45, 16)"/>
                        </pfx7:DocumentodeIdentidad>
                        <pfx7:SerialTarjeta>
                            <xsl:value-of select="substring(current(), 61, 16)"/>
                        </pfx7:SerialTarjeta>
                        <pfx7:NombreEstacion>
                            <xsl:value-of select="substring(current(), 77, 40)"/>
                        </pfx7:NombreEstacion>
                        <pfx7:CodigoEstacion>
                            <xsl:value-of select="substring(current(), 117, 7)"/>
                        </pfx7:CodigoEstacion>
                        <pfx7:IndicadorRespuesta>
                            <xsl:value-of select="tib:right(current(), 2)"/>
                        </pfx7:IndicadorRespuesta>
                    </pfx7:body>
                </xsl:for-each>
            </pfx7:root>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="CountersTotal">
        <pd:type>com.tibco.pe.core.CallProcessActivity</pd:type>
        <pd:resourceType>ae.process.subprocess</pd:resourceType>
        <pd:x>240</pd:x>
        <pd:y>35</pd:y>
        <config>
            <processName>/Novelties_Users_Transactions.Core/SendFilesMail/Send_RejectedTransactions_File/CountersTotalAR.process</processName>
        </config>
        <pd:inputBindings>
            <Input>
                <xsl:copy-of select="$ARFile/pfx7:root/pfx7:body"/>
            </Input>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="GET_AR_File">
        <pd:type>com.tibco.plugin.file.ListFilesActivity</pd:type>
        <pd:resourceType>ae.activities.ListFilesActivity</pd:resourceType>
        <pd:x>42</pd:x>
        <pd:y>230</pd:y>
        <config>
            <mode>only-files</mode>
        </config>
        <pd:inputBindings>
            <ns1:ListFilesActivityConfig>
                <fileName>
                    <xsl:value-of select="'C:\ArchivosRecaudo2\Usos\ARFile\UncifredFiles\ARB0320160810113214'"/>
                </fileName>
            </ns1:ListFilesActivityConfig>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="NotValid_Transactions">
        <pd:type>com.tibco.plugin.mapper.MapperActivity</pd:type>
        <pd:resourceType>ae.activities.MapperActivity</pd:resourceType>
        <pd:x>360</pd:x>
        <pd:y>35</pd:y>
        <config>
            <element>
                <xsd:element name="Valid_Transactions">
                    <xsd:complexType>
                        <xsd:sequence>
                            <xsd:element ref="pfx7:root" minOccurs="0" maxOccurs="unbounded"/>
                        </xsd:sequence>
                    </xsd:complexType>
                </xsd:element>
            </element>
        </config>
        <pd:inputBindings>
            <Valid_Transactions>
                <pfx7:root>
                    <xsl:copy-of select="$ARFile/pfx7:root/pfx7:header"/>
                    <xsl:for-each xmlns:xsl="http://www.w3.org/1999/XSL/Transform" select="$ARFile/pfx7:root/pfx7:body[pfx7:IndicadorRespuesta!='02']">
                        <pfx7:body>
                            <pfx7:IdentificadordeTransaccion>
                                <xsl:value-of select="pfx7:IdentificadordeTransaccion"/>
                            </pfx7:IdentificadordeTransaccion>
                            <pfx7:CodigoBanco>
                                <xsl:value-of select="pfx7:CodigoBanco"/>
                            </pfx7:CodigoBanco>
                            <pfx7:fechaTransaccion>
                                <xsl:value-of select="pfx7:fechaTransaccion"/>
                            </pfx7:fechaTransaccion>
                            <pfx7:MontodeUso>
                                <xsl:value-of select="pfx7:MontodeUso"/>
                            </pfx7:MontodeUso>
                            <pfx7:DocumentodeIdentidad>
                                <xsl:value-of select="pfx7:DocumentodeIdentidad"/>
                            </pfx7:DocumentodeIdentidad>
                            <pfx7:SerialTarjeta>
                                <xsl:value-of select="pfx7:SerialTarjeta"/>
                            </pfx7:SerialTarjeta>
                            <pfx7:NombreEstacion>
                                <xsl:value-of select="pfx7:NombreEstacion"/>
                            </pfx7:NombreEstacion>
                            <pfx7:CodigoEstacion>
                                <xsl:value-of select="pfx7:CodigoEstacion"/>
                            </pfx7:CodigoEstacion>
                            <pfx7:IndicadorRespuesta>
                                <xsl:value-of select="pfx7:IndicadorRespuesta"/>
                            </pfx7:IndicadorRespuesta>
                        </pfx7:body>
                    </xsl:for-each>
                </pfx7:root>
            </Valid_Transactions>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Processed_AT">
        <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
        <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
        <pd:x>494</pd:x>
        <pd:y>230</pd:y>
        <config>
            <variableName>Processed_at</variableName>
        </config>
        <pd:inputBindings>
            <Processed_at>
                <xsl:value-of select="tib:format-date(&quot;yyyyMMdd&quot;, tib:add-to-date(tib:create-date(substring(substring($Read-File/ns1:ReadActivityOutputTextClass/fileInfo/fileName, 6,8), 1, 4), substring(substring($Read-File/ns1:ReadActivityOutputTextClass/fileInfo/fileName, 6,8), 5, 2), substring(substring($Read-File/ns1:ReadActivityOutputTextClass/fileInfo/fileName, 6,8), 7, 2)), 0, 0, -1))"/>
            </Processed_at>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Query_Novelties_Accepted">
        <pd:type>com.tibco.plugin.jdbc.JDBCQueryActivity</pd:type>
        <pd:resourceType>ae.activities.JDBCQueryActivity</pd:resourceType>
        <pd:x>1852</pd:x>
        <pd:y>332</pd:y>
        <config>
            <timeout>%%Connections/MiddlewareDB/TimeOut%%</timeout>
            <commit>false</commit>
            <maxRows>%%Connections/MiddlewareDB/Max_Rows%%</maxRows>
            <emptyStrAsNil>false</emptyStrAsNil>
            <jdbcSharedConfig>/Connections/JDBCTIBCO.sharedjdbc</jdbcSharedConfig>
            <statement>select count(*) from Novelties_Response where status='02' and processed_at=?</statement>
            <Prepared_Param_DataType>
                <parameter>
                    <parameterName>Processed_at</parameterName>
                    <dataType>VARCHAR</dataType>
                </parameter>
            </Prepared_Param_DataType>
            <oraObjects/>
            <oraTables/>
            <QueryOutputCachedSchemaColumns>OutputColumn1</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>4</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>int</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
        </config>
        <pd:inputBindings>
            <jdbcQueryActivityInput>
                <Processed_at>
                    <xsl:value-of select="tib:format-date(&quot;yyyyMMdd&quot;, current-date())"/>
                </Processed_at>
            </jdbcQueryActivityInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Query_Novelties_Rejected">
        <pd:type>com.tibco.plugin.jdbc.JDBCQueryActivity</pd:type>
        <pd:resourceType>ae.activities.JDBCQueryActivity</pd:resourceType>
        <pd:x>1850</pd:x>
        <pd:y>245</pd:y>
        <config>
            <timeout>%%Connections/MiddlewareDB/TimeOut%%</timeout>
            <commit>false</commit>
            <maxRows>%%Connections/MiddlewareDB/Max_Rows%%</maxRows>
            <emptyStrAsNil>false</emptyStrAsNil>
            <jdbcSharedConfig>/Connections/JDBCTIBCO.sharedjdbc</jdbcSharedConfig>
            <statement>select * from Novelties_Response where status!='02' and processed_at=?</statement>
            <Prepared_Param_DataType>
                <parameter>
                    <parameterName>Processed_at</parameterName>
                    <dataType>VARCHAR</dataType>
                </parameter>
            </Prepared_Param_DataType>
            <oraObjects/>
            <oraTables/>
            <QueryOutputCachedSchemaColumns>document_id</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>card_number</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>names</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>last_name</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>second_last_name</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>address</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>status</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            <QueryOutputCachedSchemaColumns>processed_at</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
        </config>
        <pd:inputBindings>
            <jdbcQueryActivityInput>
                <Processed_at>
                    <xsl:value-of select="tib:format-date(&quot;yyyyMMdd&quot;, current-date())"/>
                </Processed_at>
            </jdbcQueryActivityInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Query_Novelties_Send">
        <pd:type>com.tibco.plugin.jdbc.JDBCQueryActivity</pd:type>
        <pd:resourceType>ae.activities.JDBCQueryActivity</pd:resourceType>
        <pd:x>2022</pd:x>
        <pd:y>332</pd:y>
        <config>
            <timeout>%%Connections/MiddlewareDB/TimeOut%%</timeout>
            <commit>false</commit>
            <maxRows>%%Connections/MiddlewareDB/Max_Rows%%</maxRows>
            <emptyStrAsNil>false</emptyStrAsNil>
            <jdbcSharedConfig>/Connections/JDBCTIBCO.sharedjdbc</jdbcSharedConfig>
            <statement>select count(*) from Novelties_Response where processed_at=?</statement>
            <Prepared_Param_DataType>
                <parameter>
                    <parameterName>Processed_at</parameterName>
                    <dataType>VARCHAR</dataType>
                </parameter>
            </Prepared_Param_DataType>
            <oraObjects/>
            <oraTables/>
            <QueryOutputCachedSchemaColumns>OutputColumn1</QueryOutputCachedSchemaColumns>
            <QueryOutputCachedSchemaDataTypes>4</QueryOutputCachedSchemaDataTypes>
            <QueryOutputCachedSchemaDataTypesName>int</QueryOutputCachedSchemaDataTypesName>
            <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
        </config>
        <pd:inputBindings>
            <jdbcQueryActivityInput>
                <Processed_at>
                    <xsl:value-of select="tib:format-date(&quot;yyyyMMdd&quot;, current-date())"/>
                </Processed_at>
            </jdbcQueryActivityInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Read File">
        <pd:type>com.tibco.plugin.file.FileReadActivity</pd:type>
        <pd:resourceType>ae.activities.FileReadActivity</pd:resourceType>
        <pd:x>138</pd:x>
        <pd:y>230</pd:y>
        <config>
            <encoding>text</encoding>
        </config>
        <pd:inputBindings>
            <ns12:ReadActivityInputClass>
                <fileName>
                    <xsl:value-of select="$GET_AR_File/ns1:ListFilesActivityOutput/files/fileInfo[1]/fullName"/>
                </fileName>
                <encoding>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Validations_Response/Encoding"/>
                </encoding>
            </ns12:ReadActivityInputClass>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Report">
        <pd:type>com.tibco.plugin.mapper.MapperActivity</pd:type>
        <pd:resourceType>ae.activities.MapperActivity</pd:resourceType>
        <pd:x>239</pd:x>
        <pd:y>230</pd:y>
        <config>
            <element>
                <xsd:element name="Reporte">
                    <xsd:complexType>
                        <xsd:sequence>
                            <xsd:element name="Numero-de-validaciones--usos--enviadas-al-banco" type="xsd:string"/>
                            <xsd:element name="Monto-total-de-validaciones-enviadas-al-banco" type="xsd:string"/>
                            <xsd:element name="Numero-total-de-validaciones-rechazadas-por-el-banco" type="xsd:string"/>
                            <xsd:element name="Monto-total-de-validaciones-rechazadas-por-el-banco" type="xsd:string"/>
                        </xsd:sequence>
                    </xsd:complexType>
                </xsd:element>
            </element>
        </config>
        <pd:inputBindings>
            <Reporte>
                <Numero-de-validaciones--usos--enviadas-al-banco>
                    <xsl:value-of select="$CountersTotal/Output/CountAcept + $CountersTotal/Output/CountRech"/>
                </Numero-de-validaciones--usos--enviadas-al-banco>
                <Monto-total-de-validaciones-enviadas-al-banco>
                    <xsl:value-of select="$CountersTotal/Output/TotalAcept + $CountersTotal/Output/TotalRech"/>
                </Monto-total-de-validaciones-enviadas-al-banco>
                <Numero-total-de-validaciones-rechazadas-por-el-banco>
                    <xsl:value-of select="$CountersTotal/Output/CountRech"/>
                </Numero-total-de-validaciones-rechazadas-por-el-banco>
                <Monto-total-de-validaciones-rechazadas-por-el-banco>
                    <xsl:value-of select="$CountersTotal/Output/TotalRech"/>
                </Monto-total-de-validaciones-rechazadas-por-el-banco>
            </Reporte>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="SQL Direct">
        <pd:type>com.tibco.plugin.jdbc.JDBCGeneralActivity</pd:type>
        <pd:resourceType>ae.activities.JDBCGeneralActivity</pd:resourceType>
        <pd:x>642</pd:x>
        <pd:y>230</pd:y>
        <config>
            <timeout>%%Connections/MiddlewareDB/TimeOut%%</timeout>
            <commit>false</commit>
            <maxRows>%%Connections/MiddlewareDB/Max_Rows%%</maxRows>
            <jdbcSharedConfig>/Connections/JDBCTIBCO.sharedjdbc</jdbcSharedConfig>
        </config>
        <pd:inputBindings>
            <jdbcGeneralActivityInput>
                <statement>
                    <xsl:value-of select="concat(&quot;select registro, card_number, processed_at, status_novelty from (select min(registro) as seq, card_number as cn2, processed_at as date from (&quot;,&#xA;&quot;select card_number as cn, max(processed_at) as max_date from Prueba_noveltyReceiverBankFile2 where processed_at &lt;=&quot;, &quot;'&quot;,$Processed_at/Processed_at,&quot;'&quot;,&#xA;&quot; group by card_number) as max_nov, Prueba_noveltyReceiverBankFile2 as tot_nov where max_nov.cn = tot_nov.card_number and max_nov.max_date = tot_nov.processed_at&quot;,&#xA;&quot; group by card_number, processed_at) as ultima_novedad, Prueba_noveltyReceiverBankFile2 as total_novedades where ultima_novedad.seq = total_novedades.registro&quot;,&#xA;&quot; and card_number IN(&quot;, $Tarjetas/Tarjetas,&quot;) and (status_novelty = '01' or status_novelty = '08') order by processed_at desc&quot;)"/>
                </statement>
            </jdbcGeneralActivityInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="SQL-Direct-00">
        <pd:type>com.tibco.plugin.jdbc.JDBCGeneralActivity</pd:type>
        <pd:resourceType>ae.activities.JDBCGeneralActivity</pd:resourceType>
        <pd:x>1146</pd:x>
        <pd:y>302</pd:y>
        <config>
            <timeout>%%Connections/MiddlewareDB/TimeOut%%</timeout>
            <commit>false</commit>
            <maxRows>%%Connections/MiddlewareDB/Max_Rows%%</maxRows>
            <jdbcSharedConfig>/Connections/JDBCTIBCO.sharedjdbc</jdbcSharedConfig>
        </config>
        <pd:inputBindings>
            <jdbcGeneralActivityInput>
                <statement>
                    <xsl:value-of select="concat(&quot;select registro, card_number, processed_at, status_novelty from (select min(registro) as seq, card_number as cn2, processed_at as date from (&quot;,&#xA;&quot;select card_number as cn, max(processed_at) as max_date from Prueba_noveltyReceiverBankFile2 where processed_at &lt;=&quot;, &quot;'&quot;,$Processed_at/Processed_at,&quot;'&quot;,&#xA;&quot; group by card_number) as max_nov, Prueba_noveltyReceiverBankFile2 as tot_nov where max_nov.cn = tot_nov.card_number and max_nov.max_date = tot_nov.processed_at&quot;,&#xA;&quot; group by card_number, processed_at) as ultima_novedad, Prueba_noveltyReceiverBankFile2 as total_novedades where ultima_novedad.seq = total_novedades.registro&quot;,&#xA;&quot; and card_number IN(&quot;, $Tarjetas/Tarjetas,&quot;) and (status_novelty = '00' or status_novelty = '17') order by processed_at desc&quot;)"/>
                </statement>
            </jdbcGeneralActivityInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="SumarInjustificados-Initial">
        <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
        <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
        <pd:x>925</pd:x>
        <pd:y>131</pd:y>
        <config>
            <variableName>SumInjustified</variableName>
        </config>
        <pd:inputBindings>
            <SumInjustified>
                <xsl:value-of select="0"/>
            </SumInjustified>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="SumarRejected-Initial-00">
        <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
        <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
        <pd:x>1047</pd:x>
        <pd:y>443</pd:y>
        <config>
            <variableName>SumRejected</variableName>
        </config>
        <pd:inputBindings>
            <SumRejected>
                <xsl:value-of select="0"/>
            </SumRejected>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="TarjetasInvalidas">
        <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
        <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
        <pd:x>493</pd:x>
        <pd:y>137</pd:y>
        <config>
            <variableName>Tarjetas</variableName>
        </config>
        <pd:inputBindings>
            <Tarjetas>
                <xsl:value-of select="concat(&quot;'&quot;, tib:concat-sequence-format($NotValid_Transactions/Valid_Transactions/pfx7:root/pfx7:body/pfx7:SerialTarjeta, &quot;','&quot;), &quot;'&quot;)"/>
            </Tarjetas>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Valid_Transactions">
        <pd:type>com.tibco.plugin.mapper.MapperActivity</pd:type>
        <pd:resourceType>ae.activities.MapperActivity</pd:resourceType>
        <pd:x>359</pd:x>
        <pd:y>230</pd:y>
        <config>
            <element>
                <xsd:element name="Valid_Transactions">
                    <xsd:complexType>
                        <xsd:sequence>
                            <xsd:element ref="pfx7:root" minOccurs="0" maxOccurs="unbounded"/>
                        </xsd:sequence>
                    </xsd:complexType>
                </xsd:element>
            </element>
        </config>
        <pd:inputBindings>
            <Valid_Transactions>
                <xsl:for-each xmlns:xsl="http://www.w3.org/1999/XSL/Transform" select="$ARFile/pfx7:root">
                    <xsl:choose>
                        <xsl:when test="$ARFile/pfx7:root/pfx7:body[pfx7:IndicadorRespuesta='02']">
                            <pfx7:root>
                                <xsl:for-each select="pfx7:header">
                                    <pfx7:header>
                                        <pfx7:Reservado>
                                            <xsl:value-of select="pfx7:Reservado"/>
                                        </pfx7:Reservado>
                                        <pfx7:NumerodeRegistros>
                                            <xsl:value-of select="pfx7:NumerodeRegistros"/>
                                        </pfx7:NumerodeRegistros>
                                        <pfx7:ValoraAcumuladodeUsos>
                                            <xsl:value-of select="pfx7:ValoraAcumuladodeUsos"/>
                                        </pfx7:ValoraAcumuladodeUsos>
                                        <pfx7:FechadeGeneraciondelArchivo>
                                            <xsl:value-of select="pfx7:FechadeGeneraciondelArchivo"/>
                                        </pfx7:FechadeGeneraciondelArchivo>
                                        <pfx7:RFU>
                                            <xsl:value-of select="pfx7:RFU"/>
                                        </pfx7:RFU>
                                    </pfx7:header>
                                </xsl:for-each>
                                <xsl:for-each select="pfx7:body">
                                    <pfx7:body>
                                        <pfx7:IdentificadordeTransaccion>
                                            <xsl:value-of select="pfx7:IdentificadordeTransaccion"/>
                                        </pfx7:IdentificadordeTransaccion>
                                        <pfx7:CodigoBanco>
                                            <xsl:value-of select="pfx7:CodigoBanco"/>
                                        </pfx7:CodigoBanco>
                                        <pfx7:fechaTransaccion>
                                            <xsl:value-of select="pfx7:fechaTransaccion"/>
                                        </pfx7:fechaTransaccion>
                                        <pfx7:MontodeUso>
                                            <xsl:value-of select="pfx7:MontodeUso"/>
                                        </pfx7:MontodeUso>
                                        <pfx7:DocumentodeIdentidad>
                                            <xsl:value-of select="pfx7:DocumentodeIdentidad"/>
                                        </pfx7:DocumentodeIdentidad>
                                        <pfx7:SerialTarjeta>
                                            <xsl:value-of select="pfx7:SerialTarjeta"/>
                                        </pfx7:SerialTarjeta>
                                        <pfx7:NombreEstacion>
                                            <xsl:value-of select="pfx7:NombreEstacion"/>
                                        </pfx7:NombreEstacion>
                                        <pfx7:CodigoEstacion>
                                            <xsl:value-of select="pfx7:CodigoEstacion"/>
                                        </pfx7:CodigoEstacion>
                                        <pfx7:IndicadorRespuesta>
                                            <xsl:value-of select="pfx7:IndicadorRespuesta"/>
                                        </pfx7:IndicadorRespuesta>
                                    </pfx7:body>
                                </xsl:for-each>
                            </pfx7:root>
                        </xsl:when>
                    </xsl:choose>
                </xsl:for-each>
            </Valid_Transactions>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Write Start_Report">
        <pd:type>com.tibco.plugin.file.FileWriteActivity</pd:type>
        <pd:resourceType>ae.activities.FileWriteActivity</pd:resourceType>
        <pd:x>491</pd:x>
        <pd:y>35</pd:y>
        <config>
            <encoding>text</encoding>
            <compressFile>None</compressFile>
            <append>true</append>
            <createMissingDirectories>true</createMissingDirectories>
        </config>
        <pd:inputBindings>
            <ns1:WriteActivityInputTextClass>
                <fileName>
                    <xsl:value-of select="concat($_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Path,&#xA;$_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Prefix,&#xA;tib:format-date(&quot;yyyyMMdd&quot;, tib:add-to-date(current-date(), 0, 0, -1)),&#xA;$_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Extension)"/>
                </fileName>
                <textContent>
                    <xsl:value-of select="concat(&quot;Informe diario tarjeta híbrida &quot;, $_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/BankName, &quot; &quot;,tib:format-date(&quot;dd/MM/yyyy&quot;, tib:add-to-date(current-date(), 0,0,-1)),&#xA;&quot;&#xA;&quot;, &quot;&#xA;&quot;,&#xA;&quot;Número de validaciones (usos) enviadas al banco: &quot;,$Report/Reporte/Numero-de-validaciones--usos--enviadas-al-banco,&quot;&#xA;&quot;,&#xA;&quot;Monto total de validaciones enviadas al banco: &quot;, $Report/Reporte/Monto-total-de-validaciones-enviadas-al-banco, &quot;&#xA;&quot;,&#xA;&quot;&#xA;&quot;,&#xA;&quot;Número total de validaciones rechazadas por el banco: &quot;, $Report/Reporte/Numero-total-de-validaciones-rechazadas-por-el-banco, &quot;&#xA;&quot;,&#xA;&quot;Monto total de validaciones rechazadas por el banco: &quot;, $Report/Reporte/Monto-total-de-validaciones-rechazadas-por-el-banco,&quot;&#xA;&quot;,&#xA;&quot;&#xA;&quot;)"/>
                </textContent>
                <encoding>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Encoding"/>
                </encoding>
            </ns1:WriteActivityInputTextClass>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Write-Detail_Start_Bank_Rejected">
        <pd:type>com.tibco.plugin.file.FileWriteActivity</pd:type>
        <pd:resourceType>ae.activities.FileWriteActivity</pd:resourceType>
        <pd:x>811</pd:x>
        <pd:y>78</pd:y>
        <config>
            <encoding>text</encoding>
            <compressFile>None</compressFile>
            <append>true</append>
            <createMissingDirectories>true</createMissingDirectories>
        </config>
        <pd:inputBindings>
            <ns1:WriteActivityInputTextClass>
                <fileName>
                    <xsl:value-of select="concat($_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Detail_Rejected_Path,&#xA;tib:format-date(&quot;yyyyMMdd&quot;, tib:add-to-date(current-date(), 0, 0, -1)),&#xA;$_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Detail_Rejected_Prefix,&#xA;$_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Extension)"/>
                </fileName>
                <textContent>
                    <xsl:value-of select="concat(&quot;Detalles Informe diario tarjeta híbrida &quot;, $_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/BankName, &quot; &quot;,tib:format-date(&quot;dd/MM/yyyy&quot;, tib:add-to-date(current-date(), 0,0,-1)),&quot;&#xA;&quot;,&quot;&#xA;&quot;,&#xA;&quot;Validaciones rechazadas por el banco sin justificación&quot;,&quot;&#xA;&quot;,&#xA;&quot;ID Transacción &quot;, &quot;&#x9;&quot;,&#xA;&quot;Codigo banco &quot;,&quot;&#x9;&quot;,&#xA;&quot; Fecha transacción &quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;&quot; Numero tarjeta &quot;,&quot;&#x9;&quot;,&#xA;&quot; Monto &quot;, &quot;&#x9;&quot;,&#xA;&quot; Nombre de estación / parada &quot;, &quot;&#x9;&quot;,&#xA;&quot; Codigo de estación &quot;, &quot;&#x9;&quot;,&quot;   &quot;,&#xA;&quot; Documento &quot;, &quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;&quot; Nombres &quot;, &quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;&quot; Primer apellido &quot;, &quot;&#x9;&quot;,&#xA;&quot; Segundo apellido &quot;, &quot;&#x9;&quot;,&#xA;&quot; Ultima novedad &quot;,&#xA;&quot;&#xA;&quot;)"/>
                </textContent>
                <encoding>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Encoding"/>
                </encoding>
            </ns1:WriteActivityInputTextClass>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Write-Detail_Start_Bank_Rejected-00">
        <pd:type>com.tibco.plugin.file.FileWriteActivity</pd:type>
        <pd:resourceType>ae.activities.FileWriteActivity</pd:resourceType>
        <pd:x>877</pd:x>
        <pd:y>443</pd:y>
        <config>
            <encoding>text</encoding>
            <compressFile>None</compressFile>
            <append>true</append>
            <createMissingDirectories>true</createMissingDirectories>
        </config>
        <pd:inputBindings>
            <ns1:WriteActivityInputTextClass>
                <fileName>
                    <xsl:value-of select="concat($_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Detail_Rejected_Path,&#xA;tib:format-date(&quot;yyyyMMdd&quot;, tib:add-to-date(current-date(), 0, 0, -1)),&#xA;$_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Detail_Rejected_Prefix,&#xA;$_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Extension)"/>
                </fileName>
                <textContent>
                    <xsl:value-of select="concat(&quot;&#xA;&quot;,&#xA;&quot;Usos rechazados por tarjetas que debieron ser bloqueadas y no se bloquearon&quot;,&quot;&#xA;&quot;,&#xA;&quot;ID Transacción &quot;, &quot;&#x9;&quot;,&#xA;&quot;Codigo banco &quot;,&quot;&#x9;&quot;,&#xA;&quot; Fecha transacción &quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;&quot; Numero tarjeta &quot;,&quot;&#x9;&quot;,&#xA;&quot; Monto &quot;, &quot;&#x9;&quot;,&#xA;&quot; Nombre de estación / parada &quot;, &quot;&#x9;&quot;,&#xA;&quot; Codigo de estación &quot;, &quot;&#x9;&quot;,&quot;   &quot;,&#xA;&quot; Documento &quot;, &quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;&quot; Nombres &quot;, &quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;&quot; Primer apellido &quot;, &quot;&#x9;&quot;,&#xA;&quot; Segundo apellido &quot;, &quot;&#x9;&quot;,&#xA;&quot; Ultima novedad &quot;, &quot;&#x9;&quot;,&#xA;&quot; Novedad Registrada en &quot;,&#xA;&quot;&#xA;&quot;)"/>
                </textContent>
                <encoding>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Encoding"/>
                </encoding>
            </ns1:WriteActivityInputTextClass>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Write-Injustified">
        <pd:type>com.tibco.plugin.file.FileWriteActivity</pd:type>
        <pd:resourceType>ae.activities.FileWriteActivity</pd:resourceType>
        <pd:x>1697</pd:x>
        <pd:y>35</pd:y>
        <config>
            <encoding>text</encoding>
            <compressFile>None</compressFile>
            <append>true</append>
            <createMissingDirectories>true</createMissingDirectories>
        </config>
        <pd:inputBindings>
            <ns1:WriteActivityInputTextClass>
                <fileName>
                    <xsl:value-of select="concat($_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Path,&#xA;$_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Prefix,&#xA;tib:format-date(&quot;yyyyMMdd&quot;, tib:add-to-date(current-date(), 0, 0, -1)),&#xA;$_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Extension)"/>
                </fileName>
                <textContent>
                    <xsl:value-of select="concat(&quot;Numero de validaciones rechazadas sin justificación: &quot;,count($SQL-Direct/jdbcGeneralActivityOutput/unknownResultset/row),  &quot;&#xA;&quot;,&#xA;&quot;Monto total de validaciones rechazadas por el banco sin justificación: &quot;,$SumInjustified/SumInjustified,&quot;&#xA;&quot;,&quot;&#xA;&quot;,&#xA;&quot;Numero de validaciones rechazadas por tarjetas que debieron ser bloqueadas y no se bloquearon: &quot;,count($SQL-Direct-00/jdbcGeneralActivityOutput/unknownResultset/row),  &quot;&#xA;&quot;,&#xA;&quot;Monto total de validaciones rechazadas por tarjetas que debieron ser bloqueadas y no se bloquearon: &quot;,$SumRejected/SumRejected,&quot;&#xA;&quot;,&quot;&#xA;&quot;,&#xA;&quot;Numero de validaciones rechazadas por otras razones: &quot;,&#xA;if ($SumInjustified/SumInjustified = 0) then '0' else $CountersTotal/Output/CountRech - count($SQL-Direct/jdbcGeneralActivityOutput/unknownResultset/row) - count($SQL-Direct-00/jdbcGeneralActivityOutput/unknownResultset/row),&quot;&#xA;&quot;,&#xA;&quot;Monto total de validaciones rechazadas por otras razones: &quot;, if ($SumInjustified/SumInjustified=0) then '0' else $Report/Reporte/Monto-total-de-validaciones-rechazadas-por-el-banco - $SumInjustified/SumInjustified -( if($SumRejected/SumRejected=0) then 0 else $SumRejected/SumRejected), &quot;&#xA;&quot;,&quot;&#xA;&quot;,&#xA;&quot;Número de novedades enviadas por el banco:  &quot;, $Query_Novelties_Send/resultSet/Record[1]/OutputColumn1,&quot;&#xA;&quot;,&#xA;&quot;Número de novedades procesadas exitosamente por el FCS: &quot;,$Query_Novelties_Accepted/resultSet/Record[1]/OutputColumn1,&quot;&#xA;&quot;,&quot;&#xA;&quot;,&#xA;&quot;Número de novedades rechazadas por el FCS: &quot;,count($Query_Novelties_Rejected/resultSet/Record),&quot;&#xA;&quot;,&#xA;&quot;Número de novedades duplicadas encontradas: &quot;,$NoveltysDuplicateFinder/Duplicated_Novelties)"/>
                </textContent>
                <encoding>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Encoding"/>
                </encoding>
            </ns1:WriteActivityInputTextClass>
        </pd:inputBindings>
    </pd:activity>
    <pd:group name="Write_Rejected_Novelties">
        <pd:type>com.tibco.pe.core.LoopGroup</pd:type>
        <pd:resourceType>ae.process.group</pd:resourceType>
        <pd:x>1420</pd:x>
        <pd:y>98</pd:y>
        <pd:width>297</pd:width>
        <pd:height>140</pd:height>
        <pd:collapsedWidth>57</pd:collapsedWidth>
        <pd:collapsedHeight>70</pd:collapsedHeight>
        <pd:groupVariables/>
        <pd:joinToggle>inherit</pd:joinToggle>
        <config>
            <pd:groupType>inputLoop</pd:groupType>
            <pd:serializable>false</pd:serializable>
            <pd:over>$Query_Novelties_Rejected/resultSet/Record</pd:over>
            <pd:iterationElementSlot>Rejected_Novelties</pd:iterationElementSlot>
            <pd:indexSlot>n</pd:indexSlot>
            <pd:activityOutputName/>
            <pd:accumulateOutput>false</pd:accumulateOutput>
        </config>
        <pd:inputBindings/>
        <pd:expanded>true</pd:expanded>
        <pd:transition>
            <pd:from>start</pd:from>
            <pd:to>Query_Novelties_Rejected_All</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:transition>
            <pd:from>Write_Detail_BankRejected_Novelties</pd:from>
            <pd:to>end</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:transition>
            <pd:from>Query_Novelties_Rejected_All</pd:from>
            <pd:to>Write_Detail_BankRejected_Novelties</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:activity name="Write_Detail_BankRejected_Novelties">
            <pd:type>com.tibco.plugin.file.FileWriteActivity</pd:type>
            <pd:resourceType>ae.activities.FileWriteActivity</pd:resourceType>
            <pd:x>1618</pd:x>
            <pd:y>175</pd:y>
            <config>
                <encoding>text</encoding>
                <compressFile>None</compressFile>
                <append>true</append>
                <createMissingDirectories>true</createMissingDirectories>
            </config>
            <pd:inputBindings>
                <ns1:WriteActivityInputTextClass>
                    <fileName>
                        <xsl:value-of select="concat($_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Detail_Rejected_Path,&#xA;tib:format-date(&quot;yyyyMMdd&quot;, tib:add-to-date(current-date(), 0, 0, -1)),&#xA;$_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Detail_Rejected_Prefix,&#xA;$_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Extension)"/>
                    </fileName>
                    <textContent>
                        <xsl:value-of select="concat($Query_Novelties_Rejected_All/resultSet/Record[1]/document_id,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;$Query_Novelties_Rejected_All/resultSet/Record[1]/card_number,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot; &quot;,&#xA;tib:pad(normalize-space(tib:trim($Query_Novelties_Rejected_All/resultSet/Record[1]/names)), 15, &quot; &quot;),&quot; &quot;,&#xA;tib:pad(normalize-space(tib:trim($Query_Novelties_Rejected_All/resultSet/Record[1]/last_name)), 20, &quot; &quot;),&#xA;tib:pad(normalize-space(tib:trim($Query_Novelties_Rejected_All/resultSet/Record[1]/second_last_name)), 20, &quot; &quot;),&quot;&#x9;&quot;,&#xA;$Query_Novelties_Rejected_All/resultSet/Record[1]/status_novelty, &quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;$Rejected_Novelties/Record/status,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;&quot;&#xA;&quot;)"/>
                    </textContent>
                    <encoding>
                        <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Encoding"/>
                    </encoding>
                </ns1:WriteActivityInputTextClass>
            </pd:inputBindings>
        </pd:activity>
        <pd:activity name="Query_Novelties_Rejected_All">
            <pd:type>com.tibco.plugin.jdbc.JDBCQueryActivity</pd:type>
            <pd:resourceType>ae.activities.JDBCQueryActivity</pd:resourceType>
            <pd:x>1506</pd:x>
            <pd:y>174</pd:y>
            <config>
                <timeout>%%Connections/MiddlewareDB/TimeOut%%</timeout>
                <commit>false</commit>
                <maxRows>%%Connections/MiddlewareDB/Max_Rows%%</maxRows>
                <emptyStrAsNil>false</emptyStrAsNil>
                <jdbcSharedConfig>/Connections/JDBCTIBCO.sharedjdbc</jdbcSharedConfig>
                <statement>select Novelties_Response.document_id, Novelties_Response.card_number, Novelties_Response.names, Novelties_Response.last_name, Novelties_Response.second_last_name, Prueba_noveltyReceiverBankFile2.status_novelty, Novelties_Response.status from Novelties_Response,  Prueba_noveltyReceiverBankFile2 where Novelties_Response.processed_at=Prueba_noveltyReceiverBankFile2.processed_at and Novelties_Response.card_number=Prueba_noveltyReceiverBankFile2.card_number and Novelties_Response.status!='02' and Prueba_noveltyReceiverBankFile2.card_number=? and Novelties_Response.processed_at=?</statement>
                <Prepared_Param_DataType>
                    <parameter>
                        <parameterName>Card_Number</parameterName>
                        <dataType>VARCHAR</dataType>
                    </parameter>
                    <parameter>
                        <parameterName>Processed_at</parameterName>
                        <dataType>VARCHAR</dataType>
                    </parameter>
                </Prepared_Param_DataType>
                <oraObjects/>
                <oraTables/>
                <QueryOutputCachedSchemaColumns>document_id</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>card_number</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>names</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>last_name</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>second_last_name</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>status_novelty</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>status</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            </config>
            <pd:inputBindings>
                <jdbcQueryActivityInput>
                    <Card_Number>
                        <xsl:choose>
                            <xsl:when test="exists($Rejected_Novelties/Record/card_number)">
                                <xsl:value-of select="$Rejected_Novelties/Record/card_number"/>
                            </xsl:when>
                            <xsl:otherwise>
                                <xsl:attribute name="xsi:nil">true</xsl:attribute>
                            </xsl:otherwise>
                        </xsl:choose>
                    </Card_Number>
                    <Processed_at>
                        <xsl:value-of select="tib:format-date(&quot;yyyyMMdd&quot;, current-date())"/>
                    </Processed_at>
                </jdbcQueryActivityInput>
            </pd:inputBindings>
        </pd:activity>
    </pd:group>
    <pd:activity name="Write-Detail_Start_Rejected_Novelties">
        <pd:type>com.tibco.plugin.file.FileWriteActivity</pd:type>
        <pd:resourceType>ae.activities.FileWriteActivity</pd:resourceType>
        <pd:x>1333</pd:x>
        <pd:y>175</pd:y>
        <config>
            <encoding>text</encoding>
            <compressFile>None</compressFile>
            <append>true</append>
            <createMissingDirectories>true</createMissingDirectories>
        </config>
        <pd:inputBindings>
            <ns1:WriteActivityInputTextClass>
                <fileName>
                    <xsl:value-of select="concat($_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Detail_Rejected_Path,&#xA;tib:format-date(&quot;yyyyMMdd&quot;, tib:add-to-date(current-date(), 0, 0, -1)),&#xA;$_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Detail_Rejected_Prefix,&#xA;$_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Extension)"/>
                </fileName>
                <textContent>
                    <xsl:value-of select="concat(&quot;&#xA;&quot;,&#xA;&quot;Novedades rechazadas por el FCS&quot;,&quot;&#xA;&quot;,&#xA;&quot;Documento &quot;, &quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;&quot;Numero tarjeta &quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot; &quot;,&#xA;&quot;Nombres &quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot; &quot;,&#xA;&quot;Primer apellido &quot;,&quot;&#x9;&quot;,&#xA;&quot;Segundo apellido &quot;,&quot;&#x9;&quot;,&#xA;&quot;Novedad banco &quot;, &quot;&#x9;&quot;,&quot;   &quot;,&#xA;&quot;Codigo rechazo FCS&quot;,&#xA;&quot;&#xA;&quot;)"/>
                </textContent>
                <encoding>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Encoding"/>
                </encoding>
            </ns1:WriteActivityInputTextClass>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="NoveltysDuplicateFinder">
        <pd:type>com.tibco.pe.core.CallProcessActivity</pd:type>
        <pd:resourceType>ae.process.subprocess</pd:resourceType>
        <pd:x>1567</pd:x>
        <pd:y>35</pd:y>
        <config>
            <processName>/Novelties_Users_Transactions.Core/SendFilesMail/Report_Transactions/NoveltysDuplicateFinder.process</processName>
        </config>
        <pd:inputBindings/>
    </pd:activity>
    <pd:activity name="Write-Detail_OthersRejected">
        <pd:type>com.tibco.plugin.file.FileWriteActivity</pd:type>
        <pd:resourceType>ae.activities.FileWriteActivity</pd:resourceType>
        <pd:x>1537</pd:x>
        <pd:y>441</pd:y>
        <config>
            <encoding>text</encoding>
            <compressFile>None</compressFile>
            <append>true</append>
            <createMissingDirectories>true</createMissingDirectories>
        </config>
        <pd:inputBindings>
            <ns1:WriteActivityInputTextClass>
                <fileName>
                    <xsl:value-of select="concat($_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Detail_Rejected_Path,&#xA;tib:format-date(&quot;yyyyMMdd&quot;, tib:add-to-date(current-date(), 0, 0, -1)),&#xA;$_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Detail_Rejected_Prefix,&#xA;$_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Extension)"/>
                </fileName>
                <textContent>
                    <xsl:value-of select="concat(&quot;&#xA;&quot;,&quot;&#xA;&quot;,&#xA;&quot;Usos rechazados por otras razones&quot;,&quot;&#xA;&quot;,&#xA;&quot;ID Transacción &quot;, &quot;&#x9;&quot;,&#xA;&quot;Codigo banco &quot;,&quot;&#x9;&quot;,&#xA;&quot; Fecha transacción &quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;&quot; Numero tarjeta &quot;,&quot;&#x9;&quot;,&#xA;&quot; Monto &quot;, &quot;&#x9;&quot;,&#xA;&quot; Nombre de estación / parada &quot;, &quot;&#x9;&quot;,&#xA;&quot; Codigo de estación &quot;, &quot;&#x9;&quot;,&quot;   &quot;,&#xA;&quot; Documento &quot;, &quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;&quot; Nombres &quot;, &quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;&quot; Primer apellido &quot;, &quot;&#x9;&quot;,&#xA;&quot; Segundo apellido &quot;, &quot;&#x9;&quot;,&#xA;&quot; Ultima novedad &quot;, &quot;&#x9;&quot;,&#xA;&quot; Novedad Registrada en &quot;,&#xA;&quot;&#xA;&quot;)"/>
                </textContent>
                <encoding>
                    <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Encoding"/>
                </encoding>
            </ns1:WriteActivityInputTextClass>
        </pd:inputBindings>
    </pd:activity>
    <pd:group name="Others_Rejected">
        <pd:type>com.tibco.pe.core.LoopGroup</pd:type>
        <pd:resourceType>ae.process.group</pd:resourceType>
        <pd:x>1601</pd:x>
        <pd:y>316</pd:y>
        <pd:width>174</pd:width>
        <pd:height>225</pd:height>
        <pd:collapsedWidth>57</pd:collapsedWidth>
        <pd:collapsedHeight>70</pd:collapsedHeight>
        <pd:groupVariables/>
        <pd:joinToggle>inherit</pd:joinToggle>
        <config>
            <pd:groupType>inputLoop</pd:groupType>
            <pd:serializable>false</pd:serializable>
            <pd:over>$SQL-Direct/jdbcGeneralActivityOutput/unknownResultset/row</pd:over>
            <pd:iterationElementSlot>TarjetasQuery</pd:iterationElementSlot>
            <pd:indexSlot>l</pd:indexSlot>
            <pd:activityOutputName/>
            <pd:accumulateOutput>false</pd:accumulateOutput>
        </config>
        <pd:inputBindings/>
        <pd:expanded>true</pd:expanded>
        <pd:transition>
            <pd:from>start</pd:from>
            <pd:to>QueryOthers_Rejected</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:transition>
            <pd:from>Catch-OthersRejected</pd:from>
            <pd:to>end</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:transition>
            <pd:from>QueryOthers_Rejected</pd:from>
            <pd:to>end</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:activity name="QueryOthers_Rejected">
            <pd:type>com.tibco.plugin.jdbc.JDBCQueryActivity</pd:type>
            <pd:resourceType>ae.activities.JDBCQueryActivity</pd:resourceType>
            <pd:x>1686</pd:x>
            <pd:y>380</pd:y>
            <config>
                <timeout>%%Connections/MiddlewareDB/TimeOut%%</timeout>
                <commit>false</commit>
                <maxRows>%%Connections/MiddlewareDB/Max_Rows%%</maxRows>
                <emptyStrAsNil>false</emptyStrAsNil>
                <jdbcSharedConfig>/Connections/JDBCTIBCO.sharedjdbc</jdbcSharedConfig>
                <statement>select transactionsresponse.TransactionSequenceNumber, transactionsresponse.UsageDate, transactionsresponse.FCSCardNumber, transactionsresponse.AmountUsed, transactionsresponse.BusStopNm, transactionsresponse.BusStopID, hcusers.DocumentID, hcusers.Names, hcusers.LastName1, hcusers.LastName2, Prueba_noveltyReceiverBankFile2.processed_at from TransactionsResponse, hcusers, Prueba_noveltyReceiverBankFile2 where TransactionsResponse.FCSCardNumber=hcusers.TransportCardNumber and TransactionsResponse.FCSCardNumber=Prueba_noveltyReceiverBankFile2.card_number and TransactionsResponse.FCSCardNumber=? and transactionsresponse.ResponseCode!='02' and ARFileName=?</statement>
                <wizardData/>
                <Prepared_Param_DataType>
                    <parameter>
                        <parameterName>FCS_CardNumber</parameterName>
                        <dataType>VARCHAR</dataType>
                    </parameter>
                    <parameter>
                        <parameterName>ARFileName</parameterName>
                        <dataType>VARCHAR</dataType>
                    </parameter>
                </Prepared_Param_DataType>
                <oraObjects/>
                <oraTables/>
                <QueryOutputCachedSchemaColumns>TransactionSequenceNumber</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>UsageDate</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>FCSCardNumber</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>AmountUsed</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>BusStopNm</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>BusStopID</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>DocumentID</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>Names</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>LastName1</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>LastName2</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
                <QueryOutputCachedSchemaColumns>processed_at</QueryOutputCachedSchemaColumns>
                <QueryOutputCachedSchemaDataTypes>12</QueryOutputCachedSchemaDataTypes>
                <QueryOutputCachedSchemaDataTypesName>varchar</QueryOutputCachedSchemaDataTypesName>
                <QueryOutputCachedSchemaStatus>OptionalElement</QueryOutputCachedSchemaStatus>
            </config>
            <pd:inputBindings>
                <jdbcQueryActivityInput>
                    <FCS_CardNumber>
                        <xsl:copy-of select="$TarjetasQuery/row/column[name='card_number']/value/@xsi:nil"/>
                        <xsl:value-of select="$TarjetasQuery/row/column[name='card_number']/value"/>
                    </FCS_CardNumber>
                    <ARFileName>
                        <xsl:value-of select="$Read-File/ns1:ReadActivityOutputTextClass/fileInfo/fileName"/>
                    </ARFileName>
                </jdbcQueryActivityInput>
            </pd:inputBindings>
        </pd:activity>
        <pd:activity name="Catch-OthersRejected">
            <pd:type>com.tibco.pe.core.CatchActivity</pd:type>
            <pd:resourceType>ae.activities.catch</pd:resourceType>
            <pd:x>1683</pd:x>
            <pd:y>466</pd:y>
            <pd:handler>true</pd:handler>
            <config>
                <catchAll>true</catchAll>
            </config>
            <pd:inputBindings/>
        </pd:activity>
    </pd:group>
    <pd:group name="Write_Others_Rejected">
        <pd:type>com.tibco.pe.core.LoopGroup</pd:type>
        <pd:resourceType>ae.process.group</pd:resourceType>
        <pd:x>1809</pd:x>
        <pd:y>431</pd:y>
        <pd:width>172</pd:width>
        <pd:height>140</pd:height>
        <pd:collapsedWidth>57</pd:collapsedWidth>
        <pd:collapsedHeight>70</pd:collapsedHeight>
        <pd:groupVariables/>
        <pd:joinToggle>inherit</pd:joinToggle>
        <config>
            <pd:groupType>inputLoop</pd:groupType>
            <pd:serializable>false</pd:serializable>
            <pd:over>$QueryOthers_Rejected/resultSet/Record</pd:over>
            <pd:iterationElementSlot>QueryOthersRejectedResult</pd:iterationElementSlot>
            <pd:indexSlot>o</pd:indexSlot>
            <pd:activityOutputName/>
            <pd:accumulateOutput>false</pd:accumulateOutput>
        </config>
        <pd:inputBindings/>
        <pd:expanded>true</pd:expanded>
        <pd:transition>
            <pd:from>start</pd:from>
            <pd:to>Write_Detail_OthersRejected</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:transition>
            <pd:from>Write_Detail_OthersRejected</pd:from>
            <pd:to>end</pd:to>
            <pd:lineType>Default</pd:lineType>
            <pd:lineColor>-16777216</pd:lineColor>
            <pd:conditionType>always</pd:conditionType>
        </pd:transition>
        <pd:activity name="Write_Detail_OthersRejected">
            <pd:type>com.tibco.plugin.file.FileWriteActivity</pd:type>
            <pd:resourceType>ae.activities.FileWriteActivity</pd:resourceType>
            <pd:x>1891</pd:x>
            <pd:y>500</pd:y>
            <config>
                <encoding>text</encoding>
                <compressFile>None</compressFile>
                <append>true</append>
                <createMissingDirectories>true</createMissingDirectories>
            </config>
            <pd:inputBindings>
                <ns1:WriteActivityInputTextClass>
                    <fileName>
                        <xsl:value-of select="concat($_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Detail_Rejected_Path,&#xA;tib:format-date(&quot;yyyyMMdd&quot;, tib:add-to-date(current-date(), 0, 0, -1)),&#xA;$_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Detail_Rejected_Prefix,&#xA;$_globalVariables/ns:GlobalVariables/Validations_Response/Rejected_Transactions/Extension)"/>
                    </fileName>
                    <textContent>
                        <xsl:value-of select="concat(substring($QueryOthersRejectedResult/Record[1]/TransactionSequenceNumber, 10, 10),&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;$_globalVariables/ns:GlobalVariables/Noveltys_Request/Bank_Code,&quot;&#x9;&quot;,&quot;&#x9;  &quot;,&quot;&#x9;&quot;,&quot; &quot;,&#xA;$QueryOthersRejectedResult/Record[1]/UsageDate,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;$QueryOthersRejectedResult/Record[1]/FCSCardNumber,&quot;&#x9;&quot;,&quot;  &quot;,&#xA;substring($QueryOthersRejectedResult/Record[1]/AmountUsed, 4, 4),&quot;&#x9;&quot;,&quot;&#x9;&quot;, &quot; &quot;,&#xA;tib:pad(tib:trim(normalize-space(substring($QueryOthersRejectedResult/Record[1]/BusStopNm, 1, 24))), 24, &quot; &quot;),&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;substring($QueryOthersRejectedResult/Record[1]/BusStopID, 3, 5),&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;$QueryOthersRejectedResult/Record[1]/DocumentID,&quot;&#x9;&quot;,&#xA;tib:pad(tib:trim(normalize-space($QueryOthersRejectedResult/Record[1]/Names)), 16, &quot; &quot;),&quot; &quot;,&#xA;tib:pad(tib:trim(normalize-space($QueryOthersRejectedResult/Record[1]/LastName1)), 16, &quot; &quot;),&quot;&#x9;&quot;,&quot; &quot;,&#xA;tib:pad(tib:trim(normalize-space($QueryOthersRejectedResult/Record[1]/LastName2)), 16, &quot; &quot;),&quot; &quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;$TarjetasQuery/row/column[name='status_novelty']/value,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&quot;&#x9;&quot;,&#xA;$QueryOthersRejectedResult/Record[1]/processed_at,&#xA;&quot;&#xA;&quot;)"/>
                    </textContent>
                    <encoding>
                        <xsl:value-of select="$_globalVariables/ns:GlobalVariables/Encoding"/>
                    </encoding>
                </ns1:WriteActivityInputTextClass>
            </pd:inputBindings>
        </pd:activity>
    </pd:group>
    <pd:transition>
        <pd:from>Start</pd:from>
        <pd:to>GET_AR_File</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>GET_AR_File</pd:from>
        <pd:to>Read File</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>ARFile</pd:from>
        <pd:to>CountersTotal</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Read File</pd:from>
        <pd:to>ARFile</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>CountersTotal</pd:from>
        <pd:to>Report</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Report</pd:from>
        <pd:to>Valid_Transactions</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Valid_Transactions</pd:from>
        <pd:to>NotValid_Transactions</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>NotValid_Transactions</pd:from>
        <pd:to>Write Start_Report</pd:to>
        <pd:lineType>One Bend</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>TarjetasInvalidas</pd:from>
        <pd:to>Processed_AT</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>SQL Direct</pd:from>
        <pd:to>Write_Invalid_Rejected</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Processed_AT</pd:from>
        <pd:to>SQL Direct</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Write Start_Report</pd:from>
        <pd:to>TarjetasInvalidas</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Write_Invalid_Rejected</pd:from>
        <pd:to>Write-Detail_Start_Bank_Rejected</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Group</pd:from>
        <pd:to>SQL-Direct-00</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Write-Detail_Start_Bank_Rejected</pd:from>
        <pd:to>SumarInjustificados-Initial</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>SumarInjustificados-Initial</pd:from>
        <pd:to>Group</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>SQL-Direct-00</pd:from>
        <pd:to>Write_Invalid_Rejected (1)</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Write_Invalid_Rejected (1)</pd:from>
        <pd:to>Write-Detail_Start_Bank_Rejected-00</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Write-Detail_Start_Bank_Rejected-00</pd:from>
        <pd:to>SumarRejected-Initial-00</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>SumarRejected-Initial-00</pd:from>
        <pd:to>Group (1)</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Group (1)</pd:from>
        <pd:to>Write-Detail_OthersRejected</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Write-Injustified</pd:from>
        <pd:to>End</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Query_Novelties_Send</pd:from>
        <pd:to>Query_Novelties_Accepted</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Query_Novelties_Accepted</pd:from>
        <pd:to>Query_Novelties_Rejected</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Query_Novelties_Rejected</pd:from>
        <pd:to>Write-Detail_Start_Rejected_Novelties</pd:to>
        <pd:lineType>One Bend</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Write-Detail_Start_Rejected_Novelties</pd:from>
        <pd:to>Write_Rejected_Novelties</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Write_Rejected_Novelties</pd:from>
        <pd:to>NoveltysDuplicateFinder</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>NoveltysDuplicateFinder</pd:from>
        <pd:to>Write-Injustified</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Write-Detail_OthersRejected</pd:from>
        <pd:to>Others_Rejected</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Others_Rejected</pd:from>
        <pd:to>Write_Others_Rejected</pd:to>
        <pd:lineType>One Bend</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Write_Others_Rejected</pd:from>
        <pd:to>Query_Novelties_Send</pd:to>
        <pd:lineType>One Bend</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
</pd:ProcessDefinition>